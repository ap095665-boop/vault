<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculator</title>

<style>
body{background:#111;font-family:monospace;color:#0f0;text-align:center}
#calc{margin-top:60px}
button{width:70px;height:60px;margin:5px;font-size:18px;border:none;border-radius:10px;background:#222;color:#0f0}
#display{width:300px;height:60px;background:#000;color:#0f0;font-size:26px;margin-bottom:15px;text-align:right;padding:10px;border-radius:10px}
.hidden{display:none}
.box{background:#000;padding:10px;margin:10px;border-radius:10px}
input{width:70%;padding:8px;margin:5px;background:#111;color:#0f0;border:none}
.copy{background:#333;width:60px;height:35px}
</style>
</head>

<body>

<div id="calc">
<input id="display" readonly><br>

<div>
<button onclick="press('7')">7</button>
<button onclick="press('8')">8</button>
<button onclick="press('9')">9</button>
</div>
<div>
<button onclick="press('4')">4</button>
<button onclick="press('5')">5</button>
<button onclick="press('6')">6</button>
</div>
<div>
<button onclick="press('1')">1</button>
<button onclick="press('2')">2</button>
<button onclick="press('3')">3</button>
</div>
<div>
<button onclick="press('0')">0</button>
<button onclick="check()">=</button>
<button onclick="clr()">C</button>
</div>
</div>

<div id="vault" class="hidden">
<h3>PRIVATE VAULT</h3>

<h4>ğŸ¦ Bank</h4>
<button onclick="addField('bank')">+ Add Bank</button>
<div id="bank"></div>

<h4>ğŸ’³ Cards</h4>
<button onclick="addField('card')">+ Add Card</button>
<div id="card"></div>

<h4>ğŸ“± UPI</h4>
<button onclick="addField('upi')">+ Add UPI</button>
<div id="upi"></div>

<h4>ğŸ‘› Wallet</h4>
<button onclick="addField('wallet')">+ Add Wallet</button>
<div id="wallet"></div>

<h4>ğŸ§© Custom</h4>
<button onclick="addField('custom')">+ Add Custom</button>
<div id="custom"></div>

<br>
<button onclick="saveData()">ğŸ’¾ SAVE DATA</button>
<button onclick="lock()">ğŸ”’ LOCK</button>
</div>

<script>
const secret="262552";
let calc="";

function press(n){calc+=n;display.value=calc}
function clr(){calc="";display.value=""}
function check(){ if(calc===secret){fingerprint()} calc="";display.value="" }

// fingerprint
async function fingerprint(){
 try{
  let saved=localStorage.getItem("fp");
  if(!saved){
   const cred=await navigator.credentials.create({
    publicKey:{
     challenge:new Uint8Array(32),
     rp:{name:"Vault"},
     user:{id:new Uint8Array(16),name:"user",displayName:"user"},
     pubKeyCredParams:[{type:"public-key",alg:-7}],
     authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"}
    }
   });
   localStorage.setItem("fp","ok");
  }else{
   await navigator.credentials.get({
    publicKey:{
     challenge:new Uint8Array(32),
     userVerification:"required"
    }
   });
  }
  openVault();
 }catch(e){alert("Fingerprint failed")}
}

function openVault(){
 calcDiv.style.display="none";
 vault.classList.remove("hidden");
 loadData();
}

function lock(){location.reload()}

// ---------- IndexedDB ----------
let db;
const request=indexedDB.open("VaultDB",1);

request.onupgradeneeded=e=>{
 db=e.target.result;
 db.createObjectStore("data",{keyPath:"id"});
};

request.onsuccess=e=>{
 db=e.target.result;
};

function saveData(){
 const data={
  bank:bank.innerHTML,
  card:card.innerHTML,
  upi:upi.innerHTML,
  wallet:wallet.innerHTML,
  custom:custom.innerHTML
 };
 const tx=db.transaction(["data"],"readwrite");
 const store=tx.objectStore("data");
 store.put({id:"vault",content:data});
 alert("Saved permanently âœ”");
}

function loadData(){
 const tx=db.transaction(["data"],"readonly");
 const store=tx.objectStore("data");
 const req=store.get("vault");
 req.onsuccess=()=>{
  if(req.result){
   const d=req.result.content;
   bank.innerHTML=d.bank||"";
   card.innerHTML=d.card||"";
   upi.innerHTML=d.upi||"";
   wallet.innerHTML=d.wallet||"";
   custom.innerHTML=d.custom||"";
  }
 };
}

// add field
function addField(section){
 let d=document.createElement("div");
 d.className="box";
 d.innerHTML=`<input placeholder="Enter data">
 <button class="copy" onclick="copyText(this)">Copy</button>`;
 document.getElementById(section).appendChild(d);
}

function copyText(btn){
 navigator.clipboard.writeText(btn.previousElementSibling.value);
}
</script>
</body>
</html>
